<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.8" />
<title>The Article Title</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}


#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="book">
<div id="header">
<h1>The Article Title</h1>
<span id="author">Alex Theodoridis</span><br />
<span id="email"><code>&lt;<a href="mailto:alekstheod@gmail.com">alekstheod@gmail.com</a>&gt;</code></span><br />
<span id="revnumber">version 1.0,</span>
<span id="revdate">April 2015</span>
<br /><span id="revremark">Version 1 release</span>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>By browsing through the web we realized that there are not so many neural network libraries
with an simple and intuitive user interface available. We thought that it
would be very interesting to construct a neural network in an easy way by
defining the types of the basic components a typical neural network consists of.
The main goal of this project actually is to provide a modern c++ framework,
flexible enough to reconstruct different neural network topologies in just few lines of code.</p></div>
<div class="paragraph"><p>Spending some time in investigation and reading the basic ideas around the artifical
neural networks we came to a conclusion that a typical neural network is not something
monolythic but it consists of the smaller parts. Which are these small parts in this case?
Well the most known to us (and biology scinetists) is a neuron. This is the point where it all
begins from :). I am about to grab some images from the google to show how the neuron looks like
in a nature and how we represent it in a software.</p></div>
<div class="paragraph"><p>here it is:</p></div>
<div class="paragraph"><p><span class="image">
<img src="./images/neuron_bio.png" alt="bio neuron" />
</span></p></div>
<div class="paragraph"><p>I intentially selected an image which is showing a data flow through the biological neuron.
How would you design this thing in a software? Well lets do some OOA first. Which parts of
the neuron are interested for us? So from the image above we can see at least 3 different parts
of the physical neuron.</p></div>
<div class="ulist"><ul>
<li>
<p>
Dendrites
</p>
</li>
<li>
<p>
Cell body
</p>
</li>
<li>
<p>
Axon
</p>
</li>
</ul></div>
<div class="paragraph"><p>Then lets take a look how the neuron is designed as a mathematical model</p></div>
<div class="paragraph"><p>here we are:</p></div>
<div class="paragraph"><p><span class="image">
<img src="./images/neuron_math.png" alt="math_neuron" />
</span></p></div>
</div>
</div>
<div class="sect1">
<h2 id="_design">Design</h2>
<div class="sectionbody">
<div class="paragraph"><p>So lets do some mapping between the mathematical representation and biological instance of an neuron.
Dendrites are the Inputs for a neuron. So Input class.
Cell body is an actuall body of a neuron therefore can be represented as a Neuron class.
Axon is represented as an activation function in a neuron. Activation function should be exchangable
because different activation functions are more or less suitable on solving different types of problems.</p></div>
<div class="sect2">
<h3 id="_neuron">Neuron</h3>
<div class="paragraph"><p>The uml diagram of an neuron is shown below.</p></div>
<div class="imageblock plantuml">
<div class="content">
<img src="./images/documentation__1.png" alt="documentation__1.png" />
</div>
</div>
<div class="paragraph"><p>Neuron is a basic brick of any artificial neural network, since we have it we can construct any type of the nn
just by reusing this class.</p></div>
</div>
<div class="sect2">
<h3 id="_neurallayer">NeuralLayer</h3>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>template<span style="color: #990000">&lt;</span>
         <span style="color: #008080">template&lt;template&lt;class&gt;</span> class<span style="color: #990000">,</span> class<span style="color: #990000">,</span> <span style="color: #009900">unsigned</span> <span style="color: #009900">int</span><span style="color: #990000">,</span> <span style="color: #009900">bool</span><span style="color: #990000">&gt;</span> <span style="color: #008080">class</span> NeuronType<span style="color: #990000">,</span>
         template<span style="color: #990000">&lt;</span>class<span style="color: #990000">&gt;</span> <span style="color: #008080">class</span> ActivationFunctionType<span style="color: #990000">,</span>
         <span style="color: #009900">unsigned</span> <span style="color: #009900">int</span> size<span style="color: #990000">,</span>
         <span style="color: #009900">unsigned</span> <span style="color: #009900">int</span> inputsNumber <span style="color: #990000">=</span> <span style="color: #993399">2</span><span style="color: #990000">,</span>
         <span style="color: #009900">bool</span> isDynamic <span style="color: #990000">=</span> false<span style="color: #990000">,</span>
         <span style="color: #008080">typename</span> Var <span style="color: #990000">=</span> <span style="color: #009900">float</span>
         <span style="color: #990000">&gt;</span>
<span style="color: #008080">using</span> NeuralLayer <span style="color: #990000">=</span> detail<span style="color: #990000">::</span>NeuralLayer<span style="color: #990000">&lt;</span> NeuronType<span style="color: #990000">&lt;</span>ActivationFunctionType<span style="color: #990000">,</span> Var<span style="color: #990000">,</span> inputsNumber<span style="color: #990000">,</span> isDynamic <span style="color: #990000">&gt;,</span> size<span style="color: #990000">,</span> inputsNumber<span style="color: #990000">,</span> isDynamic <span style="color: #990000">&gt;;</span></tt></pre></div></div>
<div class="listingblock">
<div class="content">
<pre><code>** NeuronType the type of the neurons used in this layer.
** ActivationFunctionType the activation function type used in each of the corresponding neurons.
** size the number of neurons in a neural layer.
** inputs number the number of the inputs for the current layer.
** isDynamic defines the underlying collection type if false then it will be the std::array otherwise std::vector
there are some learning algorithms which requires to have a floating number of neurons in a layer.
** Var the variable type used in this layer.</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_perceptron">Perceptron</h3>
<div class="paragraph"><p>Now lets take a look on one possible model of an artificial neural network, called
perceptron. Perceptron consists of the layers. Each layer has more than 0 neurons and amount of neurons in each
level strongly depends on the problem definition. For instance if we want to solve a simple XOR problem so that
teach our network to recognize a different types of inputs and output the particular output like in the following
table:</p></div>
<div class="tableblock">
<table rules="all"
width="10%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 1. Xor problem</caption>
<col width="33%" />
<col width="33%" />
<col width="33%" />
<thead>
<tr>
<th align="left" valign="top">Input1   </th>
<th align="left" valign="top">Input2 </th>
<th align="left" valign="top"> Output</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">0</p></td>
<td align="left" valign="top"><p class="table">0</p></td>
<td align="left" valign="top"><p class="table">0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">0</p></td>
<td align="left" valign="top"><p class="table">1</p></td>
<td align="left" valign="top"><p class="table">1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">1</p></td>
<td align="left" valign="top"><p class="table">1</p></td>
<td align="left" valign="top"><p class="table">0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">1</p></td>
<td align="left" valign="top"><p class="table">0</p></td>
<td align="left" valign="top"><p class="table">1</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Then we need two inputs in the input layer and one output (neuron) in the output layer. In tnnlib we don&#8217;t really
have an input layer instead the number of inputs for a layer is defined as a template argument. So perceptron in
tnnlib starts with the hidden layer.</p></div>
<div class="paragraph"><p>Neural network example</p></div>
<div class="paragraph"><p>There are three different types of the layers in perceptron.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>** InputLayer
** HiddenLayer
** OutputLayer</code></pre>
</div></div>
<div class="paragraph"><p>The only difference between the layers is the place where these layers are placed in a perceptron.</p></div>
<div class="paragraph"><p>example with the code:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">typedef</span></span> nn<span style="color: #990000">::</span>Perceptron<span style="color: #990000">&lt;</span><span style="color: #009900">float</span><span style="color: #990000">,</span>
        nn<span style="color: #990000">::</span>NeuralLayer<span style="color: #990000">&lt;</span>nn<span style="color: #990000">::</span>Neuron<span style="color: #990000">,</span> nn<span style="color: #990000">::</span>SigmoidFunction<span style="color: #990000">,</span> <span style="color: #993399">3</span><span style="color: #990000">,</span> <span style="color: #993399">2</span><span style="color: #990000">&gt;,</span>
        nn<span style="color: #990000">::</span>NeuralLayer<span style="color: #990000">&lt;</span>nn<span style="color: #990000">::</span>Neuron<span style="color: #990000">,</span> nn<span style="color: #990000">::</span>TanhFunction<span style="color: #990000">,</span> <span style="color: #993399">20</span><span style="color: #990000">&gt;,</span>
        nn<span style="color: #990000">::</span>NeuralLayer<span style="color: #990000">&lt;</span>nn<span style="color: #990000">::</span>Neuron<span style="color: #990000">,</span> nn<span style="color: #990000">::</span>SigmoidFunction<span style="color: #990000">,</span> <span style="color: #993399">1</span><span style="color: #990000">&gt;</span>
        <span style="color: #990000">&gt;</span> Perceptron<span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>Here we have a definition of a three (2 hidden - one output) layers perceptron. The number of inputs
is 2 see the third template argument of the first hidden layer. Thun number of neurons in a first
hidden layer is 3. The second hidden layer consists of 20 neurons and tnnlib will magically calculate
the amount of inputs needed for the second hidden layer. Finally we have an output layer which
consists only on one neuron. This neuron is rosponsible to provide the final result - decision for the
given input.</p></div>
<div class="paragraph"><p>The definition of the perceptron class is available in a Perceptron.h file</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>template<span style="color: #990000">&lt;</span><span style="color: #008080">typename</span> VarType<span style="color: #990000">,</span> typename<span style="color: #990000">...</span> NeuralLayers<span style="color: #990000">&gt;</span>
<span style="color: #008080">using</span> Perceptron <span style="color: #990000">=</span> detail<span style="color: #990000">::</span>Perceptron<span style="color: #990000">&lt;</span>VarType<span style="color: #990000">,</span> std<span style="color: #990000">::</span>tuple<span style="color: #990000">&lt;</span>NeuralLayers<span style="color: #990000">...&gt;</span> <span style="color: #990000">&gt;;</span></tt></pre></div></div>
<div class="listingblock">
<div class="content">
<pre><code>** VarType : the type of the internal variable representing the data - usually float or any other type with the floatin point and possibility to initialize by float.
** NeuralLayers a list of the neural layers. Each entry in this list should conform the INeuralLayer interface.</code></pre>
</div></div>
<div class="paragraph"><p><span class="image">
<img src="./images/perceptron.png" alt="perceptron" />
</span></p></div>
</div>
<div class="sect2">
<h3 id="_template_based_intefaces">Template based intefaces</h3>
<div class="paragraph"><p>Since in c++ we still don&#8217;t have an official support for a concepts we decided to use the
CRTP - <a href="http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern">http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern</a> in order to create a conceptial interfaces in our implementation.
An example of a neuron interface is following</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>template<span style="color: #990000">&lt;</span><span style="color: #008080">class</span> Neuron<span style="color: #990000">&gt;</span>
<span style="color: #008080">class</span> INeuron <span style="color: #FF0000">{</span>
<span style="font-weight: bold"><span style="color: #008080">public:</span></span>
    <span style="font-weight: bold"><span style="color: #0000FF">typedef</span></span> <span style="color: #008080">typename</span> Neuron<span style="color: #990000">::</span><span style="color: #008080">Var</span> Var<span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">typedef</span></span> <span style="color: #008080">typename</span> Neuron<span style="color: #990000">::</span><span style="color: #008080">OutputFunction</span> OutputFunction<span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">typedef</span></span> <span style="color: #008080">typename</span> Neuron<span style="color: #990000">::</span><span style="color: #008080">Memento</span> Memento<span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">typedef</span></span> <span style="color: #008080">typename</span> Neuron<span style="color: #990000">::</span><span style="color: #008080">Input</span> Input<span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">typedef</span></span> <span style="color: #008080">Neuron</span> NeuronType<span style="color: #990000">;</span>

<span style="font-weight: bold"><span style="color: #008080">private:</span></span>
    <span style="color: #008080">Neuron</span> m_neuron<span style="color: #990000">;</span>

<span style="font-weight: bold"><span style="color: #008080">public:</span></span>
    <span style="font-weight: bold"><span style="color: #000000">INeuron</span></span><span style="color: #990000">();</span>
    <span style="font-weight: bold"><span style="color: #000000">INeuron</span></span> <span style="color: #990000">(</span> <span style="color: #008080">Neuron</span> neuron <span style="color: #990000">)</span> <span style="color: #990000">:</span><span style="font-weight: bold"><span style="color: #000000">m_neuron</span></span> <span style="color: #990000">(</span> neuron <span style="color: #990000">);</span>
    template<span style="color: #990000">&lt;</span><span style="color: #008080">typename</span> Iterator<span style="color: #990000">&gt;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> Var<span style="color: #990000">&amp;</span> <span style="font-weight: bold"><span style="color: #000000">calculateOutput</span></span> <span style="color: #990000">(</span><span style="color: #008080">Iterator</span> begin<span style="color: #990000">,</span> <span style="color: #008080">Iterator</span> end<span style="color: #990000">);</span>
    std<span style="color: #990000">::</span><span style="color: #008080">size_t</span> <span style="font-weight: bold"><span style="color: #000000">size</span></span> <span style="color: #990000">(</span> <span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span><span style="color: #990000">;</span>
    Input<span style="color: #990000">&amp;</span> operator <span style="color: #990000">[]</span> <span style="color: #990000">(</span>std<span style="color: #990000">::</span><span style="color: #008080">size_t</span> id<span style="color: #990000">);</span>
    <span style="color: #008080">Var</span> <span style="font-weight: bold"><span style="color: #000000">getOutput</span></span><span style="color: #990000">()</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span><span style="color: #990000">;</span>
    <span style="color: #008080">Var</span> <span style="font-weight: bold"><span style="color: #000000">calcDotProduct</span></span><span style="color: #990000">()</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span><span style="color: #990000">;</span>
    <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">setInput</span></span> <span style="color: #990000">(</span> std<span style="color: #990000">::</span><span style="color: #008080">size_t</span> inputId<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> Var<span style="color: #990000">&amp;</span> value <span style="color: #990000">);</span>
    <span style="color: #009900">bool</span> <span style="font-weight: bold"><span style="color: #000000">setWeight</span></span> <span style="color: #990000">(</span> std<span style="color: #990000">::</span><span style="color: #008080">size_t</span> weightId<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> Var<span style="color: #990000">&amp;</span> weight <span style="color: #990000">);</span>
    <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> Var<span style="color: #990000">&amp;</span> <span style="font-weight: bold"><span style="color: #000000">getBias</span></span> <span style="color: #990000">()</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span><span style="color: #990000">;</span>
    <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">setBias</span></span> <span style="color: #990000">(</span> <span style="color: #008080">Var</span> weight <span style="color: #990000">);</span>
    <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> Var<span style="color: #990000">&amp;</span> <span style="font-weight: bold"><span style="color: #000000">getWeight</span></span> <span style="color: #990000">(</span>std<span style="color: #990000">::</span><span style="color: #008080">size_t</span> weightId<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span><span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> <span style="color: #008080">Memento</span> <span style="font-weight: bold"><span style="color: #000000">getMemento</span></span><span style="color: #990000">()</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span><span style="color: #990000">;</span>
    Neuron<span style="color: #990000">&amp;</span> operator<span style="color: #990000">*();</span>
    <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> Neuron<span style="color: #990000">&amp;</span> operator<span style="color: #990000">*()</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span><span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> Neuron<span style="color: #990000">*</span> operator<span style="color: #990000">-&gt;()</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span><span style="color: #990000">;</span>
    Neuron<span style="color: #990000">*</span> operator<span style="color: #990000">-&gt;();</span>
    <span style="color: #990000">~</span><span style="font-weight: bold"><span style="color: #000000">INeuron</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>The interface simply wraps the template argument and propagate all the call into it.
This concept is used all over the place in a tnn library.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture">Architecture</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_class_diagram">class diagram</h3>
<div class="paragraph"><p>In the following diagram not all the "inheritance" relations are a real inheritance relations. This is an attempt to
describe the CRTP in UML language. Especially it is true for the interfaces realization such as INeuralLayer, INeuron and IActivationFunction.</p></div>
<div class="imageblock plantuml">
<div class="content">
<img src="./images/documentation__2.png" alt="documentation__2.png" />
</div>
</div>
</div>
<div class="sect2">
<h3 id="_component_diagram">Component diagram</h3>
<div class="imageblock plantuml">
<div class="content">
<img src="./images/documentation__3.png" alt="documentation__3.png" />
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_steps">Next steps</h2>
<div class="sectionbody">
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Version 1.0<br />
Last updated 2015-11-15 22:32:59 CET
</div>
</div>
</body>
</html>
